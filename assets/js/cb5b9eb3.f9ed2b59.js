(window.webpackJsonp=window.webpackJsonp||[]).push([[100],{160:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return c})),n.d(t,"metadata",(function(){return l})),n.d(t,"toc",(function(){return s})),n.d(t,"default",(function(){return d}));var r=n(1),o=n(8),a=(n(0),n(251)),i=["components"],c={title:"Mocking new schema capabilities",description:"How to build UI features before your GraphQL API supports them"},l={unversionedId:"development-and-testing/client-schema-mocking",id:"development-and-testing/client-schema-mocking",isDocsHomePage:!1,title:"Mocking new schema capabilities",description:"How to build UI features before your GraphQL API supports them",source:"@site/docs/development-and-testing/client-schema-mocking.md",slug:"/development-and-testing/client-schema-mocking",permalink:"/docs/development-and-testing/client-schema-mocking",editUrl:"https://github.com/kamilkisiela/apollo-angular/edit/master/website/docs/development-and-testing/client-schema-mocking.md",version:"current",sidebar:"docs",previous:{title:"Testing",permalink:"/docs/development-and-testing/testing"},next:{title:"Developer tools",permalink:"/docs/development-and-testing/developer-tools"}},s=[],p={toc:s};function d(e){var t=e.components,n=Object(o.a)(e,i);return Object(a.b)("wrapper",Object(r.a)({},p,n,{components:t,mdxType:"MDXLayout"}),Object(a.b)("p",null,"Imagine we're building out a new feature in our Space Explorer app \u2014 we'd like to display a description of each rocket we can choose \u2014 but the backend support for this feature isn't going to be available for another few weeks. In keeping with schema-first design, the team has decided that we'll be adding a new field called ",Object(a.b)("inlineCode",{parentName:"p"},"description")," to an existing type in our schema called ",Object(a.b)("inlineCode",{parentName:"p"},"Rocket"),"."),Object(a.b)("p",null,"Even though this field doesn't exist in the schema yet, we can take advantage of client schemas to document it as a client-side field. In this guide, we'll walk through a simple recipe for this technique:"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"declare client-side extensions to the schema using Apollo Client"),Object(a.b)("li",{parentName:"ul"},"enhance client resolvers with mock data"),Object(a.b)("li",{parentName:"ul"},"write GraphQL queries that leverage client-only types and fields")),Object(a.b)("h1",{id:"1-extend-your-server-schema-with-a-client-only-field"},"1. Extend your server schema with a client-only field"),Object(a.b)("p",null,"Before we can include this data in the UI, we'll need to define a client schema that extends our server schema. We'll start by constructing an instance of ApolloClient with a few small additions. Simply pass in ",Object(a.b)("inlineCode",{parentName:"p"},"typeDefs")," with extensions to the schema and ",Object(a.b)("inlineCode",{parentName:"p"},"resolvers")," which actually provide the mock data:"),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre",className:"language-typescript"},"const typeDefs = gql`\n  extend type Rocket {\n    description: String!\n  }\n`;\n\nconst resolvers = {\n  Rocket: {\n    description: () => 'A boilerplate standard space rocket',\n  },\n};\n\n@NgModule({\n  import: [ApolloModule],\n  providers: [\n    {\n      provide: APOLLO_OPTIONS,\n      useFactory() {\n        return {\n          cache,\n          link,\n          typeDefs,\n          resolvers,\n        };\n      },\n    },\n  ],\n})\nexport class AppModule {}\n")),Object(a.b)("p",null,"Documenting your client-side API in Schema Definition Language is incredibly valuable, as other developers can easily see what client state is available in your app. Developers familiar with GraphQL schemas should quickly be able to understand how to query for these fields in other places throughout your app."),Object(a.b)("h1",{id:"2-introduce-richer-mock-data"},"2. Introduce richer mock data"),Object(a.b)("p",null,"Now that we have a basic resolver, we might find that during testing it's a bit boring to show the same boilerplate text every time. In fact we might want to test different lengths of text to make sure our layout still looks good. Introducing a mock data helper library such as ",Object(a.b)("a",{parentName:"p",href:"https://github.com/marak/Faker.js/"},"faker.js")," can help keep the mock data varied while testing. We can incorporate it easily into this workflow:"),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre",className:"language-typescript"},"import faker from 'faker/locale/en';\n\n// returns either 1 or 2 latin sentences\nconst oneOrTwoSentences = () =>\n  faker.lorem.sentences(Math.random() < 0.5 ? 1 : 2);\n\nconst resolvers = {\n  Rocket: {\n    description: () => oneOrTwoSentences(),\n  },\n};\n")),Object(a.b)("h1",{id:"3-query-the-mocked-field-with-the-client-directive"},"3. Query the mocked field with the @client directive"),Object(a.b)("p",null,"Now, you\u2019re ready to query your new field inside the ",Object(a.b)("inlineCode",{parentName:"p"},"RocketDetails")," component. Just add your new field to the query and specify the ",Object(a.b)("inlineCode",{parentName:"p"},"@client")," directive, and start using it in your UI."),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre",className:"language-typescript"},"const GET_ROCKET_DETAILS = gql`\n  query RocketDetails($rocketId: ID!) {\n    rocket(id: $rocketId) {\n      type\n      description @client\n    }\n  }\n`;\n\n\n\n@Component({ ... })\nexport class RocketDetailsComponent {\n  @Input() rocketId: number;\n\n  constructor(apollo: Apollo) {\n    this.apollo.watchQuery({\n      query: GET_ROCKET_DETAILS,\n      variables: { rocketId }\n    })\n  }\n}\n")),Object(a.b)("h1",{id:"4-toggle-on-real-data"},'4. Toggle on "real" data'),Object(a.b)("p",null,"Once the feature is ready on the backend, just remove the ",Object(a.b)("inlineCode",{parentName:"p"},"@client")," directive from your query. You should now be able to see your real production data returned instead. It's probably a good idea to clean up any unused client schema and resolvers at this time."))}d.isMDXComponent=!0},251:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return b}));var r=n(0),o=n.n(r);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=o.a.createContext({}),p=function(e){var t=o.a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):c(c({},t),e)),n},d=function(e){var t=p(e.components);return o.a.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.a.createElement(o.a.Fragment,{},t)}},m=o.a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,i=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),d=p(n),m=r,b=d["".concat(i,".").concat(m)]||d[m]||u[m]||a;return n?o.a.createElement(b,c(c({ref:t},s),{},{components:n})):o.a.createElement(b,c({ref:t},s))}));function b(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,i=new Array(a);i[0]=m;var c={};for(var l in t)hasOwnProperty.call(t,l)&&(c[l]=t[l]);c.originalType=e,c.mdxType="string"==typeof e?e:r,i[1]=c;for(var s=2;s<a;s++)i[s]=n[s];return o.a.createElement.apply(null,i)}return o.a.createElement.apply(null,n)}m.displayName="MDXCreateElement"}}]);